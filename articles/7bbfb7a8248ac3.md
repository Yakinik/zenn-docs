---
title: "ChatGPTã«ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ä¸€æ‹¬ã§ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ„ã‚“ã§æ¬²ã—ã„"
emoji: "ğŸ˜¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ", "ChatGPT"]
published: true
---

- [ChatGPTã«æ—¥ã€…ã®ã‚ã‚“ã©ãã•ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ã‚„ã£ã¦ã‚‚ã‚‰ãŠã†: å¿œç”¨ç·¨](5157b12c763e51)

# ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ä¸€æ‹¬ã§ãƒã‚§ãƒƒã‚¯ã—ãŸã„

## è¦æ±‚

ã–ã£ãã‚Šä»¥ä¸‹ã®ã‚ˆã†ãªäº‹ã‚’æ€ã„ã¤ã„ãŸã‚‚ã®ã¨ã™ã‚‹ã€‚

> ã‚ã€œã€ä¸€æ‹¬ã§å¤‰æ›ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãŒæ„å›³ã—ãŸã‚‚ã®ã«ãªã£ã¦ã„ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ãŸã„ãªãƒ¼ã€‚

## è¦ä»¶

è¦æ±‚ã‹ã‚‰è¦ä»¶ã«åˆ†è§£ã—ã¦ã„ãã€‚

### JSONãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

å‰é … [ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆã‚’å…ƒã«ã—ã¦æ§‹é€ åŒ–ã•ã‚ŒãŸJSONã‚’ç”Ÿæˆã—ãŸã„](#ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆã‚’å…ƒã«ã—ã¦æ§‹é€ åŒ–ã•ã‚ŒãŸJSONã‚’ç”Ÿæˆã—ãŸã„) ã§åˆ©ç”¨ã—ãŸæ§‹é€ ã‚’å†åˆ©ç”¨ã™ã‚‹ã€‚
ã¾ãŸã€JSONæ§‹é€ ãƒ†ã‚¹ãƒˆã¯ JSON Schema ã‚’åˆ©ç”¨ã—ã¦ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã™ã‚‹ã‚ˆã†ã«ã—ãŸã„ã€‚

```json: JSONãƒ‡ãƒ¼ã‚¿æ§‹é€ 
{
  "period": "å¹´ä»£",
  "artist": "ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆå",
  "trackList": [
    { "name": "æ›²å", "date": "ãƒªãƒªãƒ¼ã‚¹æ—¥", "bpm": "BPM" }
  ]
}
```

### ç´°ã‹ã„è¦ä»¶

- (ãŸã¾ã«ã¯)
Pythonã§ã‚„ã‚ŠãŸã„
- ç¬¬äºŒå¼•æ•°ã§Zipãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ãŸã„
- Zipãƒ•ã‚¡ã‚¤ãƒ«ã«å«ã¾ã‚Œã‚‹JSONå…¨ã¦ã‚’ãƒ†ã‚¹ãƒˆã—ãŸã„
- ã‚¨ãƒ©ãƒ¼ãŒã‚ã£ãŸç®‡æ‰€ã¨ã‚¨ãƒ©ãƒ¼ã®åŸå› ã‚’çŸ¥ã‚ŠãŸã„

## è¦ä»¶ã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«è½ã¨ã—è¾¼ã‚€

ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«è½ã¨ã—è¾¼ã‚€ã«ã¯ã€è¦ä»¶ã‚’è©³è¨˜ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

### JSONãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

JSONãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯å‰å›æŠ½è±¡åŒ–ã—ãŸæ§‹é€ ã¨ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã®æŒ‡å®šã®æ˜ç¤ºã§å¯¾å¿œã§ãã‚‹ã€‚

```md: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
- JSONæ§‹é€ ã‚’JSON Schemaã«å¤‰æ›ã—ãŸã„
```

### ç´°ã‹ã„è¦ä»¶

ãã‚Œãã‚Œãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå‘ã‘ã®æ–‡è¨€ã«ç›´ã™ã€‚
å¼•æ•°ã®æŒ‡å®šæ–¹æ³•ã¯æŒ‡å®šãƒ–ãƒ­ãƒƒã‚¯ã‚’ã¾ã¨ã‚ã‚‹ã¨å–ã‚Šã“ã¼ã—ã‚„ã™ã„ãŸã‚ã€åˆ¥ã®ãƒ–ãƒ­ãƒƒã‚¯ã«åˆ†ã‘ãŸã€‚

```md: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
å‡¦ç†
- Pythonã‚³ãƒ¼ãƒ‰å…¨ä½“ãŒæ¬²ã—ã„
- æŒ‡å®šã—ãŸZipãƒ•ã‚¡ã‚¤ãƒ«ã«å«ã¾ã‚Œã‚‹JSONã‚’å†å¸°çš„ã«æ¢ã—ãŸã„
- è¦‹ã¤ã‹ã£ãŸJSONå…¨ã¦ãŒã‚¹ã‚­ãƒ¼ãƒã«ä¸€è‡´ã™ã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ãŸã„
- ã‚¨ãƒ©ãƒ¼ã‚’ `{ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹} [{(å–å¾—å‡ºæ¥ã‚Œã°)ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å}]: {ã‚¨ãƒ©ãƒ¼æ–‡}` ã®å½¢ã§çŸ¥ã‚ŠãŸã„

å‘¼ã³å‡ºã—æ–¹æ³•
- ã‚³ãƒãƒ³ãƒ‰ã®ç¬¬ä¸€å¼•æ•°ã§Zipãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ãŸã„
```

## æœ€çµ‚çš„ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåŒ–ã—ãŸè¦ä»¶ã‚’ã¾ã¨ã‚ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè¡¨ç¾ã¨ãªã‚‹ã€‚

````md: æ•´ãˆãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
æ¬¡ã®æ¡ä»¶ã«å¾“ã£ã¦JSONã®æ§‹é€ ãŒæ­£ã—ã„ã‹ã‚’ç¢ºèªã™ã‚‹Pythonã‚³ãƒ¼ãƒ‰ãŒã»ã—ã„ã€‚

ãƒ†ã‚¹ãƒˆåŸºæº–ã¨ãªã‚‹JSONãƒ‡ãƒ¼ã‚¿æ§‹é€ 

```
{
  "period": "å¹´ä»£",
  "artist": "ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆå",
  "trackList": [
    { "name": "æ›²å", "date": "ãƒªãƒªãƒ¼ã‚¹æ—¥", "bpm": "BPM" }
  ]
}
```

å‡¦ç†
- Pythonã‚³ãƒ¼ãƒ‰å…¨ä½“ãŒæ¬²ã—ã„
- JSONæ§‹é€ ã‚’JSON Schemaã«å¤‰æ›ã—ãŸã„
- æŒ‡å®šã—ãŸZipãƒ•ã‚¡ã‚¤ãƒ«ã«å«ã¾ã‚Œã‚‹JSONã‚’å†å¸°çš„ã«æ¢ã—ãŸã„
- è¦‹ã¤ã‹ã£ãŸJSONå…¨ã¦ãŒã‚¹ã‚­ãƒ¼ãƒã«ä¸€è‡´ã™ã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ãŸã„
- ã‚¨ãƒ©ãƒ¼ã‚’ `{ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹} [{(å–å¾—å‡ºæ¥ã‚Œã°)ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å}]: {ã‚¨ãƒ©ãƒ¼æ–‡}` ã®å½¢ã§çŸ¥ã‚ŠãŸã„

å‘¼ã³å‡ºã—æ–¹æ³•
- ã‚³ãƒãƒ³ãƒ‰ã®ç¬¬ä¸€å¼•æ•°ã§Zipãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ãŸã„
````

## å‹•ä½œç¢ºèª

ChatGPTã‹ã‚‰è¿”å´ã®ã‚ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã€‚

- ç”Ÿæˆã‚³ãƒ¼ãƒ‰: [json_validator.py](https://github.com/Yakinik/zenn-docs/blob/main/assets/5157b12c763e51/json_validator.py)
- ç¢ºèªç”¨ãƒ‡ãƒ¼ã‚¿: [data.zip](https://github.com/Yakinik/zenn-docs/blob/main/assets/5157b12c763e51/data.zip)

ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã§ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚

```sh
% pip install zipfile jsonschema
```

```sh
% python json_validator.py data.zip
data.zip/1990/çŠ¬.json [deque(['trackList', 0, 'date'])]: 19940401 is not of type 'string'

Failed validating 'type' in schema['properties']['trackList']['items']['properties']['date']:
    {'type': 'string'}

On instance['trackList'][0]['date']:
    19940401

... ä¸­ç•¥ ...

data.zip/2010/çŒ¿.json [deque(['trackList', 0, 'date'])]: 20190909 is not of type 'string'

Failed validating 'type' in schema['properties']['trackList']['items']['properties']['date']:
    {'type': 'string'}

On instance['trackList'][0]['date']:
    20190909
```

å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã§ **"date" å€¤ãŒæ–‡å­—åˆ—ã§ã¯ãªã„** ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã„ã‚‹ã€‚
æ¯”è¼ƒã—ã¦ã¿ã‚‹ã¨ã€Pythonã‚³ãƒ¼ãƒ‰ä¸­ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã¯ "date" å€¤ã¨ "bpm" å€¤ã‚’æ–‡å­—åˆ—ã ã¨è§£é‡ˆã—ã¦ã„ã‚‹ã®ã«å¯¾ã—ã€å¤‰æ›ãƒ„ãƒ¼ãƒ«ã§å¤‰æ›ã—ãŸJSONã¯ "date" å€¤ã¨ "bpm" å€¤ã‚’æ•°å€¤ã¨ã—ã¦æ‰±ã£ã¦ã„ã‚‹ã€‚

```python: ã‚¹ã‚­ãƒ¼ãƒå®šç¾©éƒ¨åˆ†
"properties": {
  "name": {"type": "string"},
  "date": {"type": "string"},
  "bpm": {"type": "string"}
},
```

```json: ãƒ„ãƒ¼ãƒ«ã§å¤‰æ›å¾Œã®JSON
{
  "name": "é å ãˆA",
  "date": 19940401,
  "bpm": 80
}
```

## è£œå®Œ

åˆ©ç”¨æƒ³å®šä¸Šã§ã¯ "date" å€¤ã¨ "bpm" å€¤ãŒæ•°å€¤ã®ã¾ã¾ã§ã‚‚å•é¡Œã¯ç„¡ã„ãŸã‚ã€ãƒã‚§ãƒƒã‚«ãƒ¼å´ã®ãƒ«ãƒ¼ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã€‚
å¤‰æ›´ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¿½åŠ ã™ã‚‹ã€‚

```md: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
- "ãƒªãƒªãƒ¼ã‚¹æ—¥" ã¨ "BPM" ã¯ integer ã¨ã—ã¦æ‰±ã„ãŸã„
```

# å®Œæˆ

å†ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã«è²¼ä»˜ã™ã‚‹ã€‚

- å†ç”Ÿæˆå¾Œã®ã‚³ãƒ¼ãƒ‰: [json_validator_adjust.py](https://github.com/Yakinik/zenn-docs/blob/main/assets/5157b12c763e51/json_validator_adjust.py)
- ç¢ºèªç”¨ãƒ‡ãƒ¼ã‚¿: [data.zip](https://github.com/Yakinik/zenn-docs/blob/main/assets/5157b12c763e51/data.zip)

å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ã€ã‚¨ãƒ©ãƒ¼ãªãå‡¦ç†ãŒå®Œäº†ã—ãŸã€‚
æƒ³å®šé€šã‚Šå‹•ä½œã—ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ã€‚

```sh
% python json_validator_adjust.py data.zip
% 
```


- ã‚¨ãƒ©ãƒ¼ç¢ºèªç”¨ãƒ‡ãƒ¼ã‚¿: [data_invalid.zip](https://github.com/Yakinik/zenn-docs/blob/main/assets/5157b12c763e51/data_invalid.zip)

:::details å®Ÿè¡Œçµæœ
```sh
% python json_validator_adjust.py data_invalid.zip
data_invalid.zip/1990/çŠ¬.json [deque([])]: 'period' is a required property

Failed validating 'required' in schema:
    {'$schema': 'http://json-schema.org/schema#',
     'properties': {'artist': {'type': 'string'},
                    'period': {'type': 'string'},
                    'trackList': {'items': {'properties': {'bpm': {'type': 'integer'},
                                                           'date': {'type': 'integer'},
                                                           'name': {'type': 'string'}},
                                            'required': ['name',
                                                         'date',
                                                         'bpm'],
                                            'type': 'object'},
                                  'type': 'array'}},
     'required': ['period', 'artist', 'trackList'],
     'type': 'object'}

On instance:
    {'artist': 'çŠ¬',
     'trackList': [{'bpm': 80, 'date': 19940401, 'name': 'é å ãˆA'},
                   {'bpm': 60, 'date': 19991215, 'name': 'é å ãˆB'}]}
data_invalid.zip/1990/çŒ«.json: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
data_invalid.zip/2000/é´¨.json [deque([])]: 'artist' is a required property

Failed validating 'required' in schema:
    {'$schema': 'http://json-schema.org/schema#',
     'properties': {'artist': {'type': 'string'},
                    'period': {'type': 'string'},
                    'trackList': {'items': {'properties': {'bpm': {'type': 'integer'},
                                                           'date': {'type': 'integer'},
                                                           'name': {'type': 'string'}},
                                            'required': ['name',
                                                         'date',
                                                         'bpm'],
                                            'type': 'object'},
                                  'type': 'array'}},
     'required': ['period', 'artist', 'trackList'],
     'type': 'object'}

On instance:
    {'period': '2000',
     'trackList': [{'bpm': 145, 'date': 20061112, 'name': 'ãƒ”ãƒ«ãƒ”ãƒ«'}]}
data_invalid.zip/2010/çŒ¿.json [deque(['trackList', 0, 'name'])]: False is not of type 'string'

Failed validating 'type' in schema['properties']['trackList']['items']['properties']['name']:
    {'type': 'string'}

On instance['trackList'][0]['name']:
    False
```

|å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«|ã‚¨ãƒ©ãƒ¼å†…å®¹|
|:--|:--|
|data_invalid.zip/1990/çŠ¬.json|"period" å€¤ãŒå­˜åœ¨ã—ãªã„|
|data_invalid.zip/1990/çŒ«.json|ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³ã«ã‚ˆã‚‹ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼|
|data_invalid.zip/2000/é´¨.json|"artist" å€¤ãŒå­˜åœ¨ã—ãªã„|
|data_invalid.zip/2010/çŒ¿.json|"name" å€¤ãŒæ–‡å­—åˆ—ã§ã¯ãªã„|
:::

ãã‚Œãã‚Œä»•è¾¼ã‚“ã ã¨ãŠã‚Šã®ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€æƒ³å®šã—ãŸå‹•ä½œã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã ã€‚
