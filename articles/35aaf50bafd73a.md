---
title: "GPTくんの返却を自由に操りたい！"
emoji: "😸"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["プロンプト", "テンプレート", "ChatGPT"]
published: true
---

- [ChatGPTに日々のめんどくさいプログラミングをやってもらおう: 応用編](5157b12c763e51)

*注: GPT-3.5ではテンプレートが複雑化すると正しく回答できない場合があります。*

# 回答テンプレートの指定

GPTを扱う上において、返却を固定したい場合があると思う。
プロンプト上でテンプレートを指定すると、記述を守って回答してくれるようになる。

テンプレートを渡す方法は自由だが、一例としてこんな渡し方がある。

````md
以降の回答は必ず【回答テンプレート】の内容にのみ従う

【回答テンプレート】
```
あいうえおかきくけこ
```
````

すると、回答がテンプレートに従ったものになる。

![](/images/35aaf50bafd73a/example-01.png)

# テンプレートで利用できる表現

## 分岐、変数

回答テンプレート上では変数や分岐の利用ができる

*時刻で分岐するもの*と、*箱変数*、*りんご変数*を定義して、値を渡す。

````md
以降の回答は必ず【回答テンプレート】の内容にのみ従う

【回答テンプレート】
```
(おはようございます|こんにちは|こんばんは)

箱が{箱}個
りんごが{りんご}個
```

時刻: 2023/01/01 08:51
箱: 4
りんご: 20
````

以下のような回答となり、こちらのメッセージで渡す定義により回答を変動させられる

![](/images/35aaf50bafd73a/example-02.png)

## 複雑な分岐

回答の文言を複雑に分岐させたい場合、分岐のバリエーションを正規表現で渡すと判断してくれる。

````md
以降の回答は必ず【回答テンプレート】の内容にのみ従う

テンプレートの内容はランダムに回答する

【回答テンプレート】
```
こんにちは！あなたの今日のトランプを選びます。
あなたの今日のトランプは /[♡♤♧♢]([2-9JQKA]|10|Jk)/ です！
```
````

![](/images/35aaf50bafd73a/example-03.png)

## 暗黙的な処理

テンプレート中で回答に表示せず何かの処理をしてもらいたい場合は、行頭に暗黙的に処理をするための目印を付与すると処理してくれる。

````md
以降の回答は必ず【回答テンプレート】の内容にのみ従う
【回答テンプレート】中、行頭が `//` で始まる場合は文言を回答に表示せず処理を行う。

【回答テンプレート】
```
こんにちは！

// 日本のランダムな地域についての豆知識を話す
```
````

プロンプトを通す度に `//` 行の処理をおこなってくれる。

![](/images/35aaf50bafd73a/example-04.png)

# テンプレートを応用した成果物

## お嬢様アシスタント

場所と時刻に対応しておすすめ情報を話すお嬢様アシスタントを作る。
テンプレートを暗黙的な処理で埋めると勝手にいろいろし始めてしまう場合があるので、文頭に「ごきげんよう」を固定で表示する。

````md
以降の回答は必ず【回答テンプレート】の内容にのみ従う
`//` と `//` で囲われている文言は回答に表示せず処理を行う

- あなたは「ですわ」調のお嬢様アシスタントです
- ユーザーは一般人です
- 自己紹介は不要です

【回答テンプレート】
```
ごきげんよう // 季節と時刻に対応した挨拶 //

// 季節と地域に対応したおすすめの場所を話す //

// 季節と地域に対応したおすすめのレジャーを話す //
```

日時: 2023/08/10 12:00
地域: 大阪府大阪市
````

渡す時刻と地域を変更すれば対応した内容を返却してくれるので、スマホアプリなどから簡単にお嬢様を呼び出せるようになる。

![](/images/35aaf50bafd73a/example-05.png)

## JSON版お嬢様アシスタント

よりアプリで利用しやすいように返却をJSON形式に変更する。

````md
以降の回答は必ず【回答テンプレート】の内容にのみ従う
`//` と `//` で囲われている文言は回答に表示せず処理を行う

- あなたは「ですわ」調のお嬢様アシスタントです
- ユーザーは一般人です
- 自己紹介は不要です

【回答テンプレート: JSON】
```
{
  "greeting": "ごきげんよう // 季節と時刻に対応した挨拶 //",
  "place": "// 季節と地域に対応したおすすめの場所を話す //",
  "leisure": "// 季節と地域に対応したおすすめのレジャーを話す //"
}
```

日時: 2023/08/10 12:00
地域: 大阪府大阪市
````

これでかなり扱いやすくなる？

![](/images/35aaf50bafd73a/example-06.png)